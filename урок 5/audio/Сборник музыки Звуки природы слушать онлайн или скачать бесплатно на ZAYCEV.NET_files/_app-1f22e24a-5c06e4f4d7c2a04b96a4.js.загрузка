(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2827],{44751:function(t,n,e){"use strict";e.d(n,{YI:function(){return h},qZ:function(){return g},A5:function(){return m},Pq:function(){return T},wm:function(){return P},As:function(){return O},hx:function(){return w},Qz:function(){return x},WY:function(){return Z},Cs:function(){return j},Ce:function(){return D},Ai:function(){return S},MI:function(){return E},K9:function(){return A},Eq:function(){return C},nX:function(){return L},hv:function(){return R},cZ:function(){return U},Dk:function(){return N},i0:function(){return B},Ef:function(){return W},Pu:function(){return F},zb:function(){return M},HA:function(){return V},Fh:function(){return Y},bO:function(){return _},UB:function(){return q},lO:function(){return H},lW:function(){return K},js:function(){return z},Fl:function(){return J}});var r=e(67105),i=e(86420),a=e(88742),o=e.n(a),u=e(40505),c=e(80406),s=e(89631),l=e(60312),p=e(6735),f=e(30138);function d(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function y(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?d(Object(e),!0).forEach((function(n){(0,r.Z)(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):d(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}var v=(0,s.hg)("playlist/getCheckedTracks",function(){var t=(0,u.Z)(o().mark((function t(n,e){var r,i,a,u,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.trackIds,i=n.subscription,a=e.rejectWithValue,t.prev=2,t.next=5,p.Z.getCheckedTracks(r,i);case 5:return u=t.sent,c=u.data,t.abrupt("return",c);case 10:return t.prev=10,t.t0=t.catch(2),t.abrupt("return",a(t.t0));case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(n,e){return t.apply(this,arguments)}}()),k=(0,s.hg)("playlist/getTracksInfo",function(){var t=(0,u.Z)(o().mark((function t(n,e){var r,i,a,u,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.trackIds,i=n.source,a=e.rejectWithValue,t.prev=2,t.next=5,p.Z.getTracksInfo(r,i);case 5:return u=t.sent,c=u.data,t.abrupt("return",c);case 10:return t.prev=10,t.t0=t.catch(2),t.abrupt("return",a(t.t0));case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(n,e){return t.apply(this,arguments)}}()),h=function(){return function(){var t=(0,u.Z)(o().mark((function t(n,e){var r,a,u,c,s;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=e().profile.personId,a=e().playlist.activeType,u=[],"playlistOfDay"===a&&(u=(0,i.Z)(e().playlist.trackIds.playlistOfDay),n(w({plOfDayOld:u})),n(D("plOfDayOld"))),t.next=7,p.Z.getPlaylistOfDay(r);case 7:c=t.sent,s=c.data,n(w({playlistOfDay:s.trackIds})),n(O(s.tracksInfo)),n(A()),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),f.log(t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(n,e){return t.apply(this,arguments)}}()},g=function(t){return function(){var n=(0,u.Z)(o().mark((function n(e,i){var a,u,c,s,d,y,v,k,h;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a={size:0,track:"",bitrate:0,duration:"",artistName:"",playbackEnabled:!1,downloadEnabled:!1,imageJpg:"",imageWebp:"",explicit:!1,artistId:0,streaming:"",download:"",checked:!0,isArtistForeignAgent:!1},e(E({playlist:t,status:{page:1,pagesCount:1,isLoading:!0,limit:50}})),n.prev=2,"new"!==t){n.next=9;break}return n.next=6,p.Z.getNewPage(1,50,0);case 6:n.t0=n.sent,n.next=19;break;case 9:if("playlistOfDay"!==t){n.next=15;break}return n.next=12,p.Z.getPlaylistOfDay(i().profile.personId);case 12:n.t1=n.sent,n.next=18;break;case 15:return n.next=17,p.Z.getRecommendedTracksList(50);case 17:n.t1=n.sent;case 18:n.t0=n.t1;case 19:return u=n.t0,c=u.data,s=c.trackIds,d=c.tracksInfo,e(w((0,r.Z)({},t,s))),e(O(d)),n.next=26,e(A());case 26:e(E({playlist:t,status:{isLoading:!1}})),n.next=32;break;case 29:n.prev=29,n.t2=n.catch(2),f.log("e",n.t2);case 32:(y=J(t,i()))>-1&&(a=i().playlist.info[y],k=(v=a).checked,h=v.streaming,e((0,l.g0)(y,k,h,t)),e(D(t)));case 34:case"end":return n.stop()}}),n,null,[[2,29]])})));return function(t,e){return n.apply(this,arguments)}}()},m=function(t){return function(){var n=(0,u.Z)(o().mark((function n(e,r){var i,a,u,c;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=r().playlist.trackIds[t],a=r().playlist.info[i[0]],u=a.checked,c=a.streaming,e((0,l.g0)(i[0],u,c,t)),e(D(t));case 5:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}()},I=(0,s.oM)({name:"playlist",initialState:{types:[],activeType:"",info:{},trackIds:{history:[]},status:{},trackIdsRefs:{artist:"",artistSmall:"",genres:"",musicsetItem:"",search:"",articleTracks:"",track:"",popular:"",recommended:"",pageNew:"",history:""},mixedTrackIds:[]},reducers:{updateTrackIdsRefs:function(t,n){var e=n.payload;t.trackIdsRefs=y(y({},t.trackIdsRefs),e)},blockTrack:{reducer:function(t,n){var e=n.payload;t.info[e.id][e.type]=!1},prepare:function(t,n){return{payload:{id:t,type:n}}}},updateTracksInfo:function(t,n){var e=n.payload;t.info=y(y({},t.info),e)},updateTrackIds:function(t,n){var e=n.payload;t.trackIds=y(y({},t.trackIds),e)},setMixedTrackIds:function(t,n){var e=n.payload;t.mixedTrackIds=e},setPlaylistTypes:function(t,n){var e=n.payload;t.types=e},updatePlaylistTypes:function(t,n){var e=n.payload;t.types=(0,i.Z)(new Set([].concat((0,i.Z)(t.types),(0,i.Z)(e))))},setPlaylistActiveType:function(t,n){var e=n.payload;t.activeType=e},addTrackToHistory:function(t,n){var e=n.payload;t.trackIds.history.includes(e)||(t.trackIds.history=[e].concat((0,i.Z)(t.trackIds.history)).slice(0,100))},addTracksToArticleNews:function(t,n){var e=n.payload;t.trackIds[t.trackIdsRefs.articleTracks]=(0,i.Z)(new Set([].concat((0,i.Z)(t.trackIds[t.trackIdsRefs.articleTracks]),(0,i.Z)(e))))},setStatusPlaylist:function(t,n){var e=n.payload;t.status[e.playlist]=y(y({},t.status[e.playlist]),e.status)}},extraReducers:function(t){t.addCase(v.fulfilled,(function(t,n){var e,r=n.payload;t.info=y(y({},t.info),null===(e=r.tracks)||void 0===e?void 0:e.reduce((function(n,e){return n[e.id]=y(y({},t.info[e.id]),{},{streaming:e.streaming,download:e.download,checked:!0}),n}),{}))})).addCase(k.fulfilled,(function(t,n){var e=n.payload;t.info=y(y({},t.info),e.tracksInfo)}))}});n.ZP=I.reducer;var b=I.actions,T=b.updateTrackIdsRefs,P=b.blockTrack,O=b.updateTracksInfo,w=b.updateTrackIds,x=b.setMixedTrackIds,Z=b.setPlaylistTypes,j=b.updatePlaylistTypes,D=b.setPlaylistActiveType,S=b.addTrackToHistory,E=(b.addTracksToArticleNews,b.setStatusPlaylist),A=function(){return function(t,n){var e,r,i=n(),a=i.playlist.info,o=i.profile,u=(null===o||void 0===o||null===(e=o.subscription)||void 0===e||null===(r=e.list)||void 0===r?void 0:r.length)>0,c=Object.keys(a).reduce((function(t,n){return a[n].checked||t.push(n),t}),[]);if(null!==c&&void 0!==c&&c.length)return t(v({trackIds:c,subscription:u}))}},C=function(t,n){var e,r,i=n().playlist,a=i.trackIds.history,c=i.info;if(a){var s=a.filter((function(t){return!c[t]}));s.length>0&&t((e=s,r="WEB-tracks-PLAYLIST-getTrackHistoryInfo",function(){var t=(0,u.Z)(o().mark((function t(n,i){var a,u,c,s,l;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(k({trackIds:e,source:r}));case 2:a=i(),u=a.playlist,c=u.info,s=u.trackIds.history,l=s.filter((function(t){return c[t]})),n(w({history:l})),n(A());case 6:case"end":return t.stop()}}),t)})));return function(n,e){return t.apply(this,arguments)}}()))}},L=function(t,n){var e,i,a=n().playlist,c=a.info,s=a.trackIdsRefs.articleTracks,l=a.trackIds;if(l[s]){var p,f=null===(p=l[s])||void 0===p?void 0:p.filter((function(t){return!c[t]}));(null===f||void 0===f?void 0:f.length)>0&&t((e=f,i="WEB-tracks-PLAYLIST-getArticleTrackInfo",function(){var t=(0,u.Z)(o().mark((function t(n,a){var u,c,s,l,p,f;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(k({trackIds:e,source:i}));case 2:u=a(),c=u.playlist,s=c.info,l=c.trackIdsRefs.articleTracks,p=c.trackIds,f=p[l].filter((function(t){return s[t]})),n(w((0,r.Z)({},l,f))),n(A());case 6:case"end":return t.stop()}}),t)})));return function(n,e){return t.apply(this,arguments)}}()))}},R=function(t){return t.playlist.activeType},U=function(t){return t.playlist.info},N=function(t){return t.playlist.trackIds.recommended},B=function(t){return t.playlist.trackIdsRefs.track},W=function(t){return function(n){return n.playlist.trackIds[t]||[]}},F=function(t){return function(n){return n.playlist.trackIds[t]||[]}},M=function(t){return t.playlist.mixedTrackIds},V=function(t){return function(n){return n.playlist.info[t]||{}}},Y=function(t){return t.playlist.trackIds.history},_=function(t){return function(n){return t?n.playlist.status[t]||{isLoading:!1,page:1,pagesCount:1}:n.playlist.status}},q=function(t){return function(n){var e=n.playlist,r=e.types,a=e.info,o=e.trackIds,u=e.activeType,c=u?[u]:r,s=[];if(t===l.fw)s=c.reduce((function(t,n){var e,r=null===(e=o[n])||void 0===e?void 0:e.map((function(t){return y({id:t,listType:n},a[t])}));return[].concat((0,i.Z)(t),(0,i.Z)(r||[]))}),[]);else if(t===l.bZ)s=o.history.map((function(t){return y({id:t,listType:"history"},a[t])}));else if(t===l.yB){var p;s=null===o||void 0===o||null===(p=o.playlistOfDay)||void 0===p?void 0:p.map((function(t){return y({id:t,listType:"playlistOfDay"},a[t])}))}return s}},H=function(t){return function(n){var e=n.playlist,r=e.types,a=e.info,o=e.trackIds,u=e.activeType,c=u?[u]:r,s=[];if(t===l.fw)s=c.reduce((function(t,n){var e,r=null===(e=o[n])||void 0===e?void 0:e.map((function(t){return y({id:t,listType:n},a[t])}));return[].concat((0,i.Z)(t),(0,i.Z)(r||[]))}),[]);else if(t===l.bZ)s=o.history.map((function(t){return y({id:t,listType:"history"},a[t])}));else if(t===l.yB){var p;s=null===o||void 0===o||null===(p=o.playlistOfDay)||void 0===p?void 0:p.map((function(t){return y({id:t,listType:"playlistOfDay"},a[t])}))}return-1!==s.findIndex((function(t){return t.isArtistForeignAgent}))}},K=((0,c.P1)([U,R],(function(t,n){return{info:t,activeType:n}})),function(t,n,e){return function(r){return t&&n&&r.playlist.activeType===e}}),z=function(t){for(var n,e=function(n){for(var e=0;e<(null===n||void 0===n?void 0:n.length);e++){var r,i;if(null!==(r=t.playlist)&&void 0!==r&&null!==(i=r.info[n[e]])&&void 0!==i&&i.isArtistForeignAgent)return!0}return!1},r=(null===(n=t.playlist)||void 0===n?void 0:n.types)||[],i=0;i<r.length;i++){var a;if(!r[i].includes("musicset")&&!r[i].includes("artist")&&e(null===(a=t.playlist)||void 0===a?void 0:a.trackIds[r[i]]))return!0}return!1},J=function(t,n){var e=n.playlist.trackIds;if(e){var r=e[t];if(r&&r.length>0){for(var i=-1,a=0;-1===i;){var o;n.playlist.info[r[a]]&&null!==(o=n.playlist.info[r[a]])&&void 0!==o&&o.checked?i=r[a]:a+=1}return i}}return-1}},60795:function(t,n,e){"use strict";e.d(n,{Ai:function(){return f},JJ:function(){return v},ts:function(){return k},o_:function(){return h},YG:function(){return g},a6:function(){return m},xc:function(){return I},Ee:function(){return b},tU:function(){return T},w2:function(){return P},mC:function(){return O},Vn:function(){return w},EI:function(){return x},N2:function(){return Z},nf:function(){return j},$k:function(){return D},I7:function(){return S},Sx:function(){return E},OV:function(){return A},lk:function(){return C},DI:function(){return L}});var r=e(67105),i=e(88742),a=e.n(i),o=e(40505),u=e(6735),c=e(80406),s=e(89631);function l(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function p(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?l(Object(e),!0).forEach((function(n){(0,r.Z)(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):l(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}var f=(0,s.hg)("profile/getProfile",(0,o.Z)(a().mark((function t(){var n,e,r,i,o,c,s,l,p=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=p.length>0&&void 0!==p[0]?p[0]:{},e=n.req,r=n.res,i=p.length>1?p[1]:void 0,o=i.rejectWithValue,t.prev=2,c=u.s.create(e,r),t.next=6,c.getUserInfo();case 6:return s=t.sent,l=s.data,t.abrupt("return",l);case 11:return t.prev=11,t.t0=t.catch(2),t.abrupt("return",o(t.t0));case 14:case"end":return t.stop()}}),t,null,[[2,11]])})))),d=(0,s.oM)({name:"profile",initialState:{userBooks:null,photoUrl:null,name:"",email:"",login:"",fromSocial:!1,isEmailRegistration:!1,personId:null,phone:null,photo:{openPopup:!1,loadingPhoto:!1},temp:{login:null,name:null,email:null,password:null,phone:null},tempSubscription:{success:!1,message:null},subscription:{list:[]},status:{succeeded:!1,pending:!1,failed:!1},error:null,biblioUserKey:null,userId:""},reducers:{updateName:function(t,n){t.name=n.payload},updateLogin:function(t,n){t.login=n.payload},updateTempLogin:function(t,n){t.temp.login=n.payload},updateTempName:function(t,n){t.temp.name=n.payload},updateTempEmail:function(t,n){t.temp.email=n.payload},updateTempPassword:function(t,n){t.temp.password=n.payload},resetFields:function(t){return p(p({},t),{},{personId:null,phone:null,subscription:{list:[],stockEnable:!0},name:null,email:null,login:null,photoUrl:null,fromSocial:!1,biblioUserKey:null})},togglePhotoPopup:function(t){t.photo.openPopup=!t.photo.openPopup},toggleLoadingPhoto:function(t){t.photo.loadingPhoto=!t.photo.loadingPhoto},deletePhoto:function(t){t.photoUrl=null},updatePhoto:function(t,n){t.photoUrl=n.payload},updateTempSubscription:function(t,n){t.tempSubscription=n.payload},updateTempPhone:function(t,n){t.temp.phone=n.payload},resetTemps:function(t){return p(p({},t),{},{temp:{login:null,name:null,email:null,password:null,phone:null}})},setUserId:function(t,n){t.userId=n.payload}},extraReducers:function(t){t.addCase(f.pending,(function(t){return p(p({},t),{},{status:{succeeded:!1,pending:!0,failed:!1},error:null})})).addCase(f.fulfilled,(function(t,n){var e=n.payload;return p(p(p({},t),e.user),{},{status:{succeeded:!0,pending:!1,failed:!1},error:null})})).addCase(f.rejected,(function(t,n){var e,r=n.payload;return p(p({},t),{},{status:{succeeded:!1,pending:!1,failed:!0},error:null===r||void 0===r||null===(e=r.response)||void 0===e?void 0:e.data})}))}});n.ZP=d.reducer;var y=d.actions,v=y.deletePhoto,k=y.resetFields,h=y.resetTemps,g=(y.setUserId,y.toggleLoadingPhoto),m=y.togglePhotoPopup,I=y.updateLogin,b=y.updateName,T=y.updatePhoto,P=y.updateTempEmail,O=y.updateTempLogin,w=y.updateTempName,x=y.updateTempPassword,Z=y.updateTempPhone,j=(y.updateTempSubscription,function(t){return t.profile.biblioUserKey}),D=function(t){return function(n){var e,r;return null===(e=n.profile.userBooks)||void 0===e||null===(r=e.ids)||void 0===r?void 0:r.includes(t)}},S=function(t){return t.profile.subscription.stockEnable},E=function(t){return t.profile.name},A=(0,c.P1)([E,function(t){return t.profile.photoUrl}],(function(t,n){return{name:t,photoUrl:n}})),C=(0,c.P1)([function(t){var n;return null===(n=t.profile.subscription)||void 0===n?void 0:n.list}],(function(t){return{list:t}})),L=(0,c.P1)([function(t){var n;return null===(n=t.profile.userBooks)||void 0===n?void 0:n.list},function(t){var n;return null===(n=t.profile.userBooks)||void 0===n?void 0:n.ids}],(function(t,n){return{list:t,ids:n}}))}}]);